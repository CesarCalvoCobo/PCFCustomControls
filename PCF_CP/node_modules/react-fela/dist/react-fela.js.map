{"version":3,"file":"react-fela.js","sources":["../../../modules/utils/styleTypes.js","../../../modules/dom/DOMInterface.js","../../../modules/utils/warning.js","../../../modules/utils/isValidHTMLElement.js","../../../modules/dom/render.js","../../../modules/bindings/react/Provider.js","../../../modules/bindings/react/connect.js","../../../modules/utils/extractPassThroughProps.js","../../../modules/utils/resolvePassThrough.js","../../../modules/utils/assign.js","../../../modules/combineRules.js","../../../modules/bindings/react/createComponent.js","../../../modules/bindings/react/ThemeProvider.js","../../../modules/bindings/react/index.js"],"sourcesContent":["/* @flow weak */\nexport const RULE_TYPE = 1\nexport const KEYFRAME_TYPE = 2\nexport const FONT_TYPE = 3\nexport const STATIC_TYPE = 4\nexport const CLEAR_TYPE = 5\n","/* @flow weak */\nimport { RULE_TYPE } from '../utils/styleTypes'\n\nexport default function createDOMInterface(renderer, node) {\n  return (change) => {\n    // only use insertRule in production as browser devtools might have\n    // weird behavior if used together with insertRule at runtime\n    if (process.env.NODE_ENV === 'production' && change.type === RULE_TYPE && !change.media) {\n      node.sheet.insertRule(\n        `${change.selector}{${change.declaration}}`,\n        node.sheet.cssRules.length\n      )\n    } else {\n      node.textContent = renderer.renderToString()\n    }\n  }\n}\n","/* @flow weak */\n/* eslint-disable import/no-mutable-exports */\nlet warning = () => true\n\nif (process.env.NODE_ENV !== 'production') {\n  warning = (condition, message) => {\n    if (!condition) {\n      if (typeof console !== 'undefined') {\n        console.error(message); // eslint-disable-line\n      }\n    }\n  }\n}\n\nexport default warning\n","export default function isValidHTMLElement(mountNode) {\n  return mountNode && mountNode.nodeType === 1\n}\n","/* @flow weak */\nimport createDOMInterface from './DOMInterface'\nimport warning from '../utils/warning'\nimport isValidHTMLElement from '../utils/isValidHTMLElement'\n\nexport default function render(renderer, mountNode) {\n  // mountNode must be a valid HTML element to be able\n  // to set mountNode.textContent later on\n  if (!isValidHTMLElement(mountNode)) {\n    throw new Error('You need to specify a valid element node (nodeType = 1) to render into.')\n  }\n\n  // warns if the DOM node either is not a valid <style> element\n  // thus the styles do not get applied as Expected\n  // or if the node already got the data-fela-stylesheet attribute applied\n  // suggesting it is already used by another Renderer\n  warning(\n    mountNode.nodeName === 'STYLE',\n    'You are using a node other than `<style>`. Your styles might not get applied correctly.'\n  )\n\n  // mark and clean the DOM node to prevent side-effects\n  mountNode.setAttribute('data-fela-stylesheet', '')\n\n  const updateNode = createDOMInterface(renderer, mountNode)\n  renderer.subscribe(updateNode)\n\n  const css = renderer.renderToString()\n\n  if (mountNode.textContent !== css) {\n    // render currently rendered styles to the DOM once\n    mountNode.textContent = css\n  }\n}\n","/* @flow weak */\nimport { Component, PropTypes, Children } from 'react'\nimport render from '../../dom/render'\n\nexport default class Provider extends Component {\n  static propTypes = { renderer: PropTypes.object.isRequired };\n  static childContextTypes = { renderer: PropTypes.object };\n\n  getChildContext() {\n    return { renderer: this.props.renderer }\n  }\n\n  componentDidMount() {\n    const { mountNode, renderer } = this.props\n\n    if (mountNode) {\n      render(renderer, mountNode)\n    }\n  }\n\n  render() {\n    return Children.only(this.props.children)\n  }\n}\n","/* @flow weak */\n/* eslint-disable react/prefer-stateless-function */\nimport React, { Component, PropTypes } from 'react'\n\nexport default function connect(mapStylesToProps) {\n  return Comp => class EnhancedComponent extends Component {\n    // reuse the initial displayName name\n    static displayName = Comp.displayName || Comp.name || 'ConnectedFelaComponent';\n\n    static contextTypes = {\n      ...Comp.contextTypes,\n      renderer: PropTypes.object,\n      theme: PropTypes.object\n    };\n\n    render() {\n      const { renderer, theme } = this.context\n\n      const styles = mapStylesToProps({\n        ...this.props,\n        theme: theme || {}\n      })(renderer)\n\n      return <Comp {...this.props} styles={styles} />\n    }\n  }\n}\n","/* @flow weak */\nexport default function extractPassThroughProps(passThrough, ruleProps) {\n  return passThrough.reduce(\n    (output, prop) => {\n      output[prop] = ruleProps[prop]\n      return output\n    },\n    {}\n  )\n}\n","/* @flow weak */\nexport default function resolvePassThrough(passThrough, ruleProps) {\n  if (passThrough instanceof Function) {\n    return Object.keys(passThrough(ruleProps))\n  }\n\n  return passThrough\n}\n","/* @flow weak */\nexport default function assign(base, ...extendingStyles) {\n  for (let i = 0, len = extendingStyles.length; i < len; ++i) {\n    const style = extendingStyles[i]\n\n    for (const property in style) {\n      const value = style[property]\n\n      if (base[property] instanceof Object && value instanceof Object) {\n        base[property] = assign({}, base[property], value)\n      } else {\n        base[property] = value\n      }\n    }\n  }\n\n  return base\n}\n","/* @flow weak */\nimport assign from './utils/assign'\n\nexport default function combineRules(...rules) {\n  return (props) => {\n    const style = {}\n\n    for (let i = 0, len = rules.length; i < len; ++i) {\n      assign(style, rules[i](props))\n    }\n\n    return style\n  }\n}\n","/* @flow weak */\nimport { createElement, PropTypes } from 'react'\n\nimport extractPassThroughProps from '../../utils/extractPassThroughProps'\nimport resolvePassThrough from '../../utils/resolvePassThrough'\nimport combineRules from '../../combineRules'\n\nexport default function createComponent(rule, type = 'div', passThroughProps = []) {\n  const FelaComponent = (\n    { children, _felaRule, passThrough = [], ...ruleProps },\n    { renderer, theme }\n  ) => {\n    const combinedRule = _felaRule ? combineRules(rule, _felaRule) : rule\n\n      // compose passThrough props from arrays or functions\n    const resolvedPassThrough = [\n      ...resolvePassThrough(passThroughProps, ruleProps),\n      ...resolvePassThrough(passThrough, ruleProps)\n    ]\n\n      // if the component renders into another Fela component\n      // we pass down the combinedRule as well as both\n    if (type._isFelaComponent) {\n      return createElement(\n          type,\n        {\n          _felaRule: combinedRule,\n          passThrough: resolvedPassThrough,\n          ...ruleProps\n        },\n          children\n        )\n    }\n\n    const componentProps = extractPassThroughProps(resolvedPassThrough, ruleProps)\n\n    componentProps.style = ruleProps.style\n    componentProps.id = ruleProps.id\n\n    const cls = ruleProps.className ? `${ruleProps.className} ` : ''\n    ruleProps.theme = theme || {}\n\n    componentProps.className = cls + renderer.renderRule(combinedRule, ruleProps)\n    return createElement(type, componentProps, children)\n  }\n\n  FelaComponent.contextTypes = {\n    renderer: PropTypes.object,\n    theme: PropTypes.object\n  }\n\n  // use the rule name as display name to better debug with react inspector\n  FelaComponent.displayName = rule.name ? rule.name : 'FelaComponent'\n  FelaComponent._isFelaComponent = true\n\n  return FelaComponent\n}\n","/* @flow weak */\nimport { Component, PropTypes, Children } from 'react'\n\nexport default class ThemeProvider extends Component {\n  static propTypes = {\n    theme: PropTypes.object.isRequired,\n    overwrite: PropTypes.bool\n  };\n  static childContextTypes = { theme: PropTypes.object };\n  static contextTypes = { theme: PropTypes.object };\n  static defaultProps = { overwrite: false };\n\n  getChildContext() {\n    const { overwrite, theme } = this.props\n    const previousTheme = this.context.theme\n\n    return {\n      theme: {\n        ...(!overwrite ? previousTheme || {} : {}),\n        ...theme\n      }\n    }\n  }\n\n  render() {\n    return Children.only(this.props.children)\n  }\n}\n","/* @flow weak */\nimport Provider from './Provider'\nimport connect from './connect'\nimport createComponent from './createComponent'\nimport ThemeProvider from './ThemeProvider'\n\nexport default {\n  Provider,\n  connect,\n  createComponent,\n  ThemeProvider\n}\n"],"names":["RULE_TYPE","createDOMInterface","renderer","node","change","type","media","textContent","renderToString","warning","condition","message","console","error","isValidHTMLElement","mountNode","nodeType","render","Error","nodeName","setAttribute","updateNode","subscribe","css","Provider","props","Children","only","children","Component","propTypes","PropTypes","object","isRequired","childContextTypes","connect","mapStylesToProps","context","theme","styles","React","displayName","Comp","name","contextTypes","extractPassThroughProps","passThrough","ruleProps","reduce","output","prop","resolvePassThrough","Function","Object","keys","assign","base","extendingStyles","i","len","length","style","property","value","combineRules","rules","createComponent","rule","passThroughProps","FelaComponent","_felaRule","combinedRule","resolvedPassThrough","_isFelaComponent","createElement","componentProps","id","cls","className","renderRule","ThemeProvider","overwrite","previousTheme","bool","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;AACA,EAAO,IAAMA,YAAY,CAAlB;;ECEQ,SAASC,kBAAT,CAA4BC,QAA5B,EAAsCC,IAAtC,EAA4C;AACzD,EAAA,SAAO,UAACC,MAAD,EAAY;AACjB,EAAA;AACA,EAAA;AACA,EAAA,QAAI,SAAyCA,OAAOC,IAAP,KAAgBL,SAAzD,IAAsE,CAACI,OAAOE,KAAlF,EAAyF,EAAzF,MAKO;AACLH,EAAAA,WAAKI,WAAL,GAAmBL,SAASM,cAAT,EAAnB;AACD,EAAA;AACF,EAAA,GAXD;AAYD,EAAA;;EChBD;AACA,EAAA;AACA,EAAA,IAAIC,UAAU;AAAA,EAAA,SAAM,IAAN;AAAA,EAAA,CAAd;;AAEA,EAAA,UAA2C;AACzCA,EAAAA,YAAU,iBAACC,SAAD,EAAYC,OAAZ,EAAwB;AAChC,EAAA,QAAI,CAACD,SAAL,EAAgB;AACd,EAAA,UAAI,OAAOE,OAAP,KAAmB,WAAvB,EAAoC;AAClCA,EAAAA,gBAAQC,KAAR,CAAcF,OAAd,EADkC;AAEnC,EAAA;AACF,EAAA;AACF,EAAA,GAND;AAOD,EAAA;;AAED,kBAAeF,OAAf;;ECde,SAASK,kBAAT,CAA4BC,SAA5B,EAAuC;AACpD,EAAA,SAAOA,aAAaA,UAAUC,QAAV,KAAuB,CAA3C;AACD,EAAA;;ECGc,SAASC,MAAT,CAAgBf,QAAhB,EAA0Ba,SAA1B,EAAqC;AAClD,EAAA;AACA,EAAA;AACA,EAAA,MAAI,CAACD,mBAAmBC,SAAnB,CAAL,EAAoC;AAClC,EAAA,UAAM,IAAIG,KAAJ,CAAU,yEAAV,CAAN;AACD,EAAA;;AAED,EAAA;AACA,EAAA;AACA,EAAA;AACA,EAAA;AACA,EAAA,YACEH,UAAUI,QAAV,KAAuB,OADzB,EAEE,yFAFF;;AAKA,EAAA;AACAJ,EAAAA,YAAUK,YAAV,CAAuB,sBAAvB,EAA+C,EAA/C;;AAEA,EAAA,MAAMC,aAAapB,mBAAmBC,QAAnB,EAA6Ba,SAA7B,CAAnB;AACAb,EAAAA,WAASoB,SAAT,CAAmBD,UAAnB;;AAEA,EAAA,MAAME,MAAMrB,SAASM,cAAT,EAAZ;;AAEA,EAAA,MAAIO,UAAUR,WAAV,KAA0BgB,GAA9B,EAAmC;AACjC,EAAA;AACAR,EAAAA,cAAUR,WAAV,GAAwBgB,GAAxB;AACD,EAAA;AACF,EAAA;;MC7BoBC;;;;;;;;;;wCAID;AAChB,EAAA,aAAO,EAAEtB,UAAU,KAAKuB,KAAL,CAAWvB,QAAvB,EAAP;AACD,EAAA;;;0CAEmB;AAAA,EAAA,mBACc,KAAKuB,KADnB;AAAA,EAAA,UACVV,SADU,UACVA,SADU;AAAA,EAAA,UACCb,QADD,UACCA,QADD;;;AAGlB,EAAA,UAAIa,SAAJ,EAAe;AACbE,EAAAA,eAAOf,QAAP,EAAiBa,SAAjB;AACD,EAAA;AACF,EAAA;;;+BAEQ;AACP,EAAA,aAAOW,eAASC,IAAT,CAAc,KAAKF,KAAL,CAAWG,QAAzB,CAAP;AACD,EAAA;;;IAlBmCC;;AAAjBL,EAAAA,SACZM,YAAY,EAAE5B,UAAU6B,gBAAUC,MAAV,CAAiBC,UAA7B;AADAT,EAAAA,SAEZU,oBAAoB,EAAEhC,UAAU6B,gBAAUC,MAAtB;;ECFd,SAASG,OAAT,CAAiBC,gBAAjB,EAAmC;AAChD,EAAA,SAAO;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;AAAA,EAAA;;AAAA,EAAA;AAAA,EAAA;;AACL,EAAA;AADK,EAAA,iCAUI;AAAA,EAAA,yBACqB,KAAKC,OAD1B;AAAA,EAAA,cACCnC,QADD,YACCA,QADD;AAAA,EAAA,cACWoC,KADX,YACWA,KADX;;;AAGP,EAAA,cAAMC,SAASH,0CACV,KAAKX,KADK;AAEba,EAAAA,mBAAOA,SAAS;AAFH,EAAA,cAGZpC,QAHY,CAAf;;AAKA,EAAA,iBAAOsC,6BAAC,IAAD,2BAAU,KAAKf,KAAf,IAAsB,QAAQc,MAA9B,IAAP;AACD,EAAA;AAnBI,EAAA;AAAA,EAAA;AAAA,EAAA,MAAwCV,eAAxC,UAEEY,WAFF,GAEgBC,KAAKD,WAAL,IAAoBC,KAAKC,IAAzB,IAAiC,wBAFjD,SAIEC,YAJF,4BAKAF,KAAKE,YALL;AAMH1C,EAAAA,gBAAU6B,gBAAUC,MANjB;AAOHM,EAAAA,aAAOP,gBAAUC;AAPd,EAAA;AAAA,EAAA,GAAP;AAqBD,EAAA;;EC1BD;AACA,EAAe,SAASa,uBAAT,CAAiCC,WAAjC,EAA8CC,SAA9C,EAAyD;AACtE,EAAA,SAAOD,YAAYE,MAAZ,CACL,UAACC,MAAD,EAASC,IAAT,EAAkB;AAChBD,EAAAA,WAAOC,IAAP,IAAeH,UAAUG,IAAV,CAAf;AACA,EAAA,WAAOD,MAAP;AACD,EAAA,GAJI,EAKL,EALK,CAAP;AAOD,EAAA;;ECTD;AACA,EAAe,SAASE,kBAAT,CAA4BL,WAA5B,EAAyCC,SAAzC,EAAoD;AACjE,EAAA,MAAID,uBAAuBM,QAA3B,EAAqC;AACnC,EAAA,WAAOC,OAAOC,IAAP,CAAYR,YAAYC,SAAZ,CAAZ,CAAP;AACD,EAAA;;AAED,EAAA,SAAOD,WAAP;AACD,EAAA;;ECPD;AACA,EAAe,SAASS,MAAT,CAAgBC,IAAhB,EAA0C;AAAA,EAAA,oCAAjBC,eAAiB;AAAjBA,EAAAA,mBAAiB;AAAA,EAAA;;AACvD,EAAA,OAAK,IAAIC,IAAI,CAAR,EAAWC,MAAMF,gBAAgBG,MAAtC,EAA8CF,IAAIC,GAAlD,EAAuD,EAAED,CAAzD,EAA4D;AAC1D,EAAA,QAAMG,QAAQJ,gBAAgBC,CAAhB,CAAd;;AAEA,EAAA,SAAK,IAAMI,QAAX,IAAuBD,KAAvB,EAA8B;AAC5B,EAAA,UAAME,QAAQF,MAAMC,QAAN,CAAd;;AAEA,EAAA,UAAIN,KAAKM,QAAL,aAA0BT,MAA1B,IAAoCU,iBAAiBV,MAAzD,EAAiE;AAC/DG,EAAAA,aAAKM,QAAL,IAAiBP,OAAO,EAAP,EAAWC,KAAKM,QAAL,CAAX,EAA2BC,KAA3B,CAAjB;AACD,EAAA,OAFD,MAEO;AACLP,EAAAA,aAAKM,QAAL,IAAiBC,KAAjB;AACD,EAAA;AACF,EAAA;AACF,EAAA;;AAED,EAAA,SAAOP,IAAP;AACD,EAAA;;ECdc,SAASQ,YAAT,GAAgC;AAAA,EAAA,oCAAPC,KAAO;AAAPA,EAAAA,SAAO;AAAA,EAAA;;AAC7C,EAAA,SAAO,UAACxC,KAAD,EAAW;AAChB,EAAA,QAAMoC,QAAQ,EAAd;;AAEA,EAAA,SAAK,IAAIH,IAAI,CAAR,EAAWC,MAAMM,MAAML,MAA5B,EAAoCF,IAAIC,GAAxC,EAA6C,EAAED,CAA/C,EAAkD;AAChDH,EAAAA,aAAOM,KAAP,EAAcI,MAAMP,CAAN,EAASjC,KAAT,CAAd;AACD,EAAA;;AAED,EAAA,WAAOoC,KAAP;AACD,EAAA,GARD;AASD,EAAA;;ECNc,SAASK,eAAT,CAAyBC,IAAzB,EAAoE;AAAA,EAAA,MAArC9D,IAAqC,uEAA9B,KAA8B;AAAA,EAAA,MAAvB+D,gBAAuB,uEAAJ,EAAI;;AACjF,EAAA,MAAMC,gBAAgB,SAAhBA,aAAgB,cAGjB;AAAA,EAAA,QADDnE,QACC,SADDA,QACC;AAAA,EAAA,QADSoC,KACT,SADSA,KACT;AAAA,EAAA,QAFDV,QAEC,QAFDA,QAEC;AAAA,EAAA,QAFS0C,SAET,QAFSA,SAET;AAAA,EAAA,gCAFoBxB,WAEpB;AAAA,EAAA,QAFoBA,WAEpB,oCAFkC,EAElC;AAAA,EAAA,QAFyCC,SAEzC;;AACH,EAAA,QAAMwB,eAAeD,YAAYN,aAAaG,IAAb,EAAmBG,SAAnB,CAAZ,GAA4CH,IAAjE;;AAEE,EAAA;AACF,EAAA,QAAMK,+DACDrB,mBAAmBiB,gBAAnB,EAAqCrB,SAArC,CADC,kCAEDI,mBAAmBL,WAAnB,EAAgCC,SAAhC,CAFC,EAAN;;AAKE,EAAA;AACA,EAAA;AACF,EAAA,QAAI1C,KAAKoE,gBAAT,EAA2B;AACzB,EAAA,aAAOC,oBACHrE,IADG;AAGHiE,EAAAA,mBAAWC,YAHR;AAIHzB,EAAAA,qBAAa0B;AAJV,EAAA,SAKAzB,SALA,GAOHnB,QAPG,CAAP;AASD,EAAA;;AAED,EAAA,QAAM+C,iBAAiB9B,wBAAwB2B,mBAAxB,EAA6CzB,SAA7C,CAAvB;;AAEA4B,EAAAA,mBAAed,KAAf,GAAuBd,UAAUc,KAAjC;AACAc,EAAAA,mBAAeC,EAAf,GAAoB7B,UAAU6B,EAA9B;;AAEA,EAAA,QAAMC,MAAM9B,UAAU+B,SAAV,GAAyB/B,UAAU+B,SAAnC,SAAkD,EAA9D;AACA/B,EAAAA,cAAUT,KAAV,GAAkBA,SAAS,EAA3B;;AAEAqC,EAAAA,mBAAeG,SAAf,GAA2BD,MAAM3E,SAAS6E,UAAT,CAAoBR,YAApB,EAAkCxB,SAAlC,CAAjC;AACA,EAAA,WAAO2B,oBAAcrE,IAAd,EAAoBsE,cAApB,EAAoC/C,QAApC,CAAP;AACD,EAAA,GApCD;;AAsCAyC,EAAAA,gBAAczB,YAAd,GAA6B;AAC3B1C,EAAAA,cAAU6B,gBAAUC,MADO;AAE3BM,EAAAA,WAAOP,gBAAUC;AAFU,EAAA,GAA7B;;AAKA,EAAA;AACAqC,EAAAA,gBAAc5B,WAAd,GAA4B0B,KAAKxB,IAAL,GAAYwB,KAAKxB,IAAjB,GAAwB,eAApD;AACA0B,EAAAA,gBAAcI,gBAAd,GAAiC,IAAjC;;AAEA,EAAA,SAAOJ,aAAP;AACD,EAAA;;MCrDoBW;;;;;;;;;;wCASD;AAAA,EAAA,mBACa,KAAKvD,KADlB;AAAA,EAAA,UACRwD,SADQ,UACRA,SADQ;AAAA,EAAA,UACG3C,KADH,UACGA,KADH;;AAEhB,EAAA,UAAM4C,gBAAgB,KAAK7C,OAAL,CAAaC,KAAnC;;AAEA,EAAA,aAAO;AACLA,EAAAA,wCACM,CAAC2C,SAAD,GAAaC,iBAAiB,EAA9B,GAAmC,EADzC,EAEK5C,KAFL;AADK,EAAA,OAAP;AAMD,EAAA;;;+BAEQ;AACP,EAAA,aAAOZ,eAASC,IAAT,CAAc,KAAKF,KAAL,CAAWG,QAAzB,CAAP;AACD,EAAA;;;IAvBwCC;;AAAtBmD,EAAAA,cACZlD,YAAY;AACjBQ,EAAAA,SAAOP,gBAAUC,MAAV,CAAiBC,UADP;AAEjBgD,EAAAA,aAAWlD,gBAAUoD;AAFJ,EAAA;AADAH,EAAAA,cAKZ9C,oBAAoB,EAAEI,OAAOP,gBAAUC,MAAnB;AALRgD,EAAAA,cAMZpC,eAAe,EAAEN,OAAOP,gBAAUC,MAAnB;AANHgD,EAAAA,cAOZI,eAAe,EAAEH,WAAW,KAAb;;cCJT;AACbzD,EAAAA,oBADa;AAEbW,EAAAA,kBAFa;AAGb+B,EAAAA,kCAHa;AAIbc,EAAAA;AAJa,EAAA,CAAf;;;;"}